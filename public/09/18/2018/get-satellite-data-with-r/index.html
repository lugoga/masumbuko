<!DOCTYPE html>
<html lang="en-us">
  <head>
    <meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="generator" content="Hugo 0.51" />


<title>Getting and Processing Satellite Data made easier in R - Masumbuko Semba&#39;s Blog</title>
<meta property="og:title" content="Getting and Processing Satellite Data made easier in R - Masumbuko Semba&#39;s Blog">



  








<link href='//cdn.bootcss.com/highlight.js/9.11.0/styles/github.min.css' rel='stylesheet' type='text/css' />



<link rel="stylesheet" href="/css/fonts.css" media="all">
<link rel="stylesheet" href="/css/main.css" media="all">



  </head>
  <body>
    <div class="wrapper">
      <header class="header">
        <nav class="nav">
  <a href="/" class="nav-logo">
    <img src="/images/grani_logo-01.png"
         width="50"
         height="50"
         alt="Logo">
  </a>

  <ul class="nav-links">
    
    <li><a href="/about/">About</a></li>
    
    <li><a href="/post/">Posts</a></li>
    
    <li><a href="/publication/">Publications</a></li>
    
    <li><a href="/project/">Projects</a></li>
    
    <li><a href="https://github.com/lugoga">GitHub</a></li>
    
    <li><a href="/links/">Links</a></li>
    
    <li><a href="/resume/">Resume</a></li>
    
  </ul>
</nav>

      </header>


<main class="content" role="main">

  <article class="article">
    
    <span class="article-duration">13 min read</span>
    

    <h1 class="article-title">Getting and Processing Satellite Data made easier in R</h1>

    
    <span class="article-date">2018/09/18</span>
    

    <div class="article-content">
      


<div id="introduction-a-brief-overview" class="section level3">
<h3>Introduction: A Brief Overview</h3>
<p>The amount of data being generated by satellites has soared in recent years. The proliferation of remote sensing data can be explained by recent advancements in satellite technologies. However, according to Febvre<a href="#fn1" class="footnoteRef" id="fnref1"><sup>1</sup></a>, this advancement set another challenge of handling and processing pentabyte of data satellite generates. Thanks to <a href="https://coastwatch.pfeg.noaa.gov/erddap/index.html">ERDDAP</a>, for being in front-line to overcome this challenge. We can obtain satellite data within the geographical extent of the area we are interested. The ERDDAP server provides simple and consistent way to subset and download oceanographic datasets from satellites and buoys to your area of interest. ERDDAP is providing free public access to huge amounts of environmental datasets. Current the ERDDAP server has a list of 1385 <a href="https://coastwatch.pfeg.noaa.gov/erddap/info/index.html?page=1&amp;itemsPerPage=1000">datasets</a>.This server allows scientist to request data of a specific area of interest in two forms—grids or tabular data.</p>
<p><em>xtractomatic</em> is R package developed by Roy Mendelssohn<a href="#fn2" class="footnoteRef" id="fnref2"><sup>2</sup></a> that works with ERDDAP servers. The <em>xtractomatic</em> functions were originally developed for the marine science, to match up ship track and tagged animals with satellites data. Some of the satellite data includes sea-surface temperature, sea-surface chlorophyll, sea-surface height, sea-surface salinity, and wind vector. However, the package has been expanded and it can now handle gridded environmental satellite data from ERDAPP server.</p>
<p>In this post I will show two main routine operations extractomatic package can do. The first one is to match up drifter observation data with modis sea surface temperature satellite data using <em>xtracto</em> function. The second operation involves <em>xtracto_3D</em> to extract gridded data of sea surface temperature and chlorophyll a, both acquired by MODIS sensors.</p>
</div>
<div id="packages-required-for-the-process" class="section level3">
<h3>Packages Required for the Process</h3>
<p>Besides <em>xtractomatic</em> package, I am going to load other packages for data procesing and visualization. These packages include <em>tidyverse</em><a href="#fn3" class="footnoteRef" id="fnref3"><sup>3</sup></a>, <em>lubridate</em><a href="#fn4" class="footnoteRef" id="fnref4"><sup>4</sup></a>, <em>spData</em><a href="#fn5" class="footnoteRef" id="fnref5"><sup>5</sup></a>, <em>sf</em><a href="#fn6" class="footnoteRef" id="fnref6"><sup>6</sup></a>, <em>oce</em><a href="#fn7" class="footnoteRef" id="fnref7"><sup>7</sup></a>, and <em>insol</em><a href="#fn8" class="footnoteRef" id="fnref8"><sup>8</sup></a> that I will use to manipulate, tidy, analyse and visulize the extracted SST and chl-a data from MODIS satellite. The chunk below shows the package needed to accomplish the task in this post</p>
<pre class="r"><code>## load the package needed for the routine
# require(DT)
require(tidyverse)
require(lubridate)
require(spData)
require(sf)
require(oce)
require(insol)
require(xtractomatic)
# require(pals)</code></pre>
</div>
<div id="area-of-interest-pemba-channel" class="section level3">
<h3>Area of Interest: Pemba Channel</h3>
<p>I chose the Pemba channel figure <a href="#fig:aoi">1</a> to demonstrate the process of obtaining the environmental and oceanographical data from ERDDAP server. Briefly, the Pemba channel is the deepest channel when compared to other two channel found in Tanzania water—Zanzibar and Mafia channel. Because of deep bottom topography, the water in the Pemba channel is the least and oceanographic information in this channel is a formidable hurdle. I decided to use free satellite data and open-source sofware to bring up the environmental dynamics in this important channel. The channel is known for its small pelagic fishery that support local people as source of food and income.</p>
<pre class="r"><code>##  Map the Pemba channel with ggplot2, sf and ggsn packages
ggplot()+geom_sf(data = tz.ke, fill = &quot;ivory&quot;, col = 1)+
  coord_sf(xlim = c(38.5, 40), ylim = c(-6,-4))+
  theme_bw()+
  theme(panel.background = element_rect(colour = 1, fill = &quot;lightblue&quot;),
        panel.grid = element_line(colour = NA),
        axis.text = element_text(colour = 1, size = 10))+
  scale_x_continuous(breaks = seq(38.5, 40, length.out = 4)%&gt;%round(digits = 1))+
  scale_y_continuous(breaks = seq(-5.8, -4.1,length.out = 5)%&gt;%round(digits = 1))+
  labs(x = NULL, y = NULL)+
  geom_text(aes(x = 39.36, y = -5.2, label = &quot;Pemba\nChannel&quot;), col = &quot;black&quot;)+
  ggsn::scalebar(location = &quot;bottomright&quot;, x.min = 38.5, 
                 x.max = 39.95, y.min = -6, y.max = -4, dist = 25, dd2km = T, 
                 model = &quot;WGS84&quot;,st.dist = 0.02, st.size = 4)</code></pre>
<div class="figure"><span id="fig:aoi"></span>
<img src="/post/2018-09-19-get-satellite-data-with-r_files/figure-html/aoi-1.png" alt=" A map showing the location of the Pemba channel in the Indian Ocean Region (WIO)" width="672" />
<p class="caption">
Figure 1:  A map showing the location of the Pemba channel in the Indian Ocean Region (WIO)
</p>
</div>
</div>
<div id="argo-floats-serve-as-tagging-features" class="section level3">
<h3>Argo Floats serve as tagging features</h3>
<p>Argo data provide sufficient information for tracking the water masses and the physical propoerties of the upper layer of the world oceans. Argo float with World Meteorological Identification number 1901124 that crossed the coastal water of Tanzania was downloaded as the actual Argo NetCDF files from the <a href="http://www.argo.ucsd.edu/Argo_data_and.html">Argo Data website</a>. Processing Argo float data I used oce package developed by Dan Kelley and Clark Richards. The oce package has <em>read.argo</em> function that read directly NetCDF file from Argo floats.</p>
<pre class="r"><code>## read argo file
argo.1901124 = read.argo(&quot;E:/Doctoral/udsm/Processing/argo_profile/csiro/1901124/1901124_prof.nc&quot;)%&gt;%handleFlags()

## make a section using the profiles recorded in argo float
argo.section = argo.1901124%&gt;%as.section()</code></pre>
<p>Once the argo float profile data was imported in the workspace, was converted to hydrographic section that was used to plot sections of temperature against time (Figure <a href="#fig:temperatureTime">2</a>) and temperature against longitude (Figure <a href="#fig:temperatureLongitude">3</a>) from the surface to 1000 meter deep.</p>
<pre class="r"><code>argo.section%&gt;%plot(which = &quot;temperature&quot;, ztype = &quot;image&quot;, xtype = &quot;time&quot;, ylim = c(1000,0))</code></pre>
<div class="figure"><span id="fig:temperatureTime"></span>
<img src="/post/2018-09-19-get-satellite-data-with-r_files/figure-html/temperatureTime-1.png" alt="Hydrographic Section of Temperature obtained after combining float profiles of Argo float" width="672" />
<p class="caption">
Figure 2: Hydrographic Section of Temperature obtained after combining float profiles of Argo float
</p>
</div>
<pre class="r"><code>argo.section%&gt;%plot(which = &quot;temperature&quot;, ztype = &quot;image&quot;, xtype = &quot;longitude&quot;, ylim = c(1000,0))</code></pre>
<div class="figure"><span id="fig:temperatureLongitude"></span>
<img src="/post/2018-09-19-get-satellite-data-with-r_files/figure-html/temperatureLongitude-1.png" alt="Hydrographic Section of Salinity obtained after combining float profiles of Argo float" width="672" />
<p class="caption">
Figure 3: Hydrographic Section of Salinity obtained after combining float profiles of Argo float
</p>
</div>
<p>To obtain Argo floats profile within the Pemba channel, I subset based on location and drop all profiles that were outside the geographical extent of the channel. Figure <a href="#fig:pemba">4</a> show the six stations that the argo floats made vertical measurements of temperature and salinity close to the Pemba channel during the southeast monsoon season.</p>
<pre class="r"><code>par(mfrow = c(1,2))
argo.section%&gt;%subset(latitude&lt;=-3.5 &amp; longitude &lt; 41)%&gt;%plot(ztype = &quot;contour&quot;, xtype = &quot;time&quot;, ylim = c(500,0), showStations = T, which = c(&quot;map&quot;,&quot;temperature&quot;), clongitude = c(35, 41))</code></pre>
<div class="figure"><span id="fig:pemba"></span>
<img src="/post/2018-09-19-get-satellite-data-with-r_files/figure-html/pemba-1.png" alt="Section at Pemba channel" width="672" />
<p class="caption">
Figure 4: Section at Pemba channel
</p>
</div>
</div>
<div id="make-a-tibble-from-argo-section" class="section level3">
<h3>Make A tibble from Argo Section</h3>
<p>A tibble is a modern data frame. Hadley Wickham declared that to change an old language like R and its traditional data fame that were useful 10 or 20 years ago, depend on the innovations in packages. One of those packages is the ecosystem of tidyverse that use pipe(%&gt;%) operator and tibble for its operations. To make a tibble out of argo section. I converted the section into a list and then extracted the longitude and latitude information. I found that time is stored in the metadata slot and not the data slot. Being in different slot make it hard to extract</p>
<pre class="r"><code>## convert argo section to list
argo.list = argo.section[[&quot;station&quot;]]

## extract lon from the argo list
longitude = argo.section[[&quot;longitude&quot;, &quot;byStation&quot;]]

## extract lat from the argo list
latitude = argo.section[[&quot;latitude&quot;, &quot;byStation&quot;]]

## time can not be extracte the same way lon and lat can. This is because the time is stored in the 
time = argo.section[[&quot;time&quot;, &quot;byStation&quot;]]</code></pre>
<p>Once I have the argo list fromt the section dataset, I plot the profile of the five casts measured close to the Pemba channel (Figure <a href="#fig:prof">5</a>). These cast are labelled with station number 206 to 2011 from 2014-06-19 to 2014-08-07</p>
<pre class="r"><code>par(mfrow = c(2,3))
argo.list[[206]]%&gt;%plot(which = 1)
argo.list[[207]]%&gt;%plot(which = 1)
argo.list[[208]]%&gt;%plot(which = 1)
argo.list[[209]]%&gt;%plot(which = 1)
argo.list[[210]]%&gt;%plot(which = 1)
argo.list[[211]]%&gt;%plot(which = 1)</code></pre>
<div class="figure"><span id="fig:prof"></span>
<img src="/post/2018-09-19-get-satellite-data-with-r_files/figure-html/prof-1.png" alt="Temperature profile off the Pemba Island measured wth Argo float between" width="672" />
<p class="caption">
Figure 5: Temperature profile off the Pemba Island measured wth Argo float between
</p>
</div>
<pre class="r"><code>## extract Argo float profiles of station 206
profile.01 = argo.list[[206]]@data%&gt;%
  as.data.frame()%&gt;%
  as.tibble()%&gt;%
  mutate(Date = argo.list[[206]]@metadata$startTime%&gt;%as_datetime(tz = &quot;&quot;), 
         Longitude = argo.list[[206]]@metadata$longitude, 
         Latitude = argo.list[[206]]@metadata$latitude)%&gt;%
  separate(Date, c(&quot;Date&quot;, &quot;Time&quot;),sep = &quot; &quot;, remove = TRUE)%&gt;%
  dplyr::select(Scan = scan, Date, Time, Longitude, Latitude, 
                Depth = pressure, Temperature = temperature, 
                Salinity = salinity)</code></pre>
<p>Table 1 shows the temperature and salinity from the surface to 800 meter deep of station 206 at this location 7.909S 40.372E during the southeast monsoon period of 2014-06-19. Although this cast contain 71 scans only the first ten rows are shown.</p>
<pre class="r"><code>knitr::kable(profile.01%&gt;%slice(1:10), caption = &quot;Table 1: Overview of CTD measurement of first cast of Argo float number 1901124&quot;, digits = 2, align = &quot;c&quot;, row.names = FALSE, escape = T)</code></pre>
<table>
<caption><span id="tab:unnamed-chunk-5">Table 1: </span>Table 1: Overview of CTD measurement of first cast of Argo float number 1901124</caption>
<thead>
<tr class="header">
<th align="center">Scan</th>
<th align="center">Date</th>
<th align="center">Time</th>
<th align="center">Longitude</th>
<th align="center">Latitude</th>
<th align="center">Depth</th>
<th align="center">Temperature</th>
<th align="center">Salinity</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center">1</td>
<td align="center">2014-06-19</td>
<td align="center">04:30:45</td>
<td align="center">40.37</td>
<td align="center">-7.91</td>
<td align="center">4.0</td>
<td align="center">27.16</td>
<td align="center">35.01</td>
</tr>
<tr class="even">
<td align="center">2</td>
<td align="center">2014-06-19</td>
<td align="center">04:30:45</td>
<td align="center">40.37</td>
<td align="center">-7.91</td>
<td align="center">9.4</td>
<td align="center">27.16</td>
<td align="center">35.01</td>
</tr>
<tr class="odd">
<td align="center">3</td>
<td align="center">2014-06-19</td>
<td align="center">04:30:45</td>
<td align="center">40.37</td>
<td align="center">-7.91</td>
<td align="center">19.2</td>
<td align="center">27.16</td>
<td align="center">35.01</td>
</tr>
<tr class="even">
<td align="center">4</td>
<td align="center">2014-06-19</td>
<td align="center">04:30:45</td>
<td align="center">40.37</td>
<td align="center">-7.91</td>
<td align="center">28.8</td>
<td align="center">27.17</td>
<td align="center">35.01</td>
</tr>
<tr class="odd">
<td align="center">5</td>
<td align="center">2014-06-19</td>
<td align="center">04:30:45</td>
<td align="center">40.37</td>
<td align="center">-7.91</td>
<td align="center">39.5</td>
<td align="center">27.17</td>
<td align="center">35.01</td>
</tr>
<tr class="even">
<td align="center">6</td>
<td align="center">2014-06-19</td>
<td align="center">04:30:45</td>
<td align="center">40.37</td>
<td align="center">-7.91</td>
<td align="center">49.6</td>
<td align="center">27.15</td>
<td align="center">35.01</td>
</tr>
<tr class="odd">
<td align="center">7</td>
<td align="center">2014-06-19</td>
<td align="center">04:30:45</td>
<td align="center">40.37</td>
<td align="center">-7.91</td>
<td align="center">59.6</td>
<td align="center">26.92</td>
<td align="center">35.00</td>
</tr>
<tr class="even">
<td align="center">8</td>
<td align="center">2014-06-19</td>
<td align="center">04:30:45</td>
<td align="center">40.37</td>
<td align="center">-7.91</td>
<td align="center">69.6</td>
<td align="center">26.02</td>
<td align="center">35.00</td>
</tr>
<tr class="odd">
<td align="center">9</td>
<td align="center">2014-06-19</td>
<td align="center">04:30:45</td>
<td align="center">40.37</td>
<td align="center">-7.91</td>
<td align="center">79.3</td>
<td align="center">25.04</td>
<td align="center">35.04</td>
</tr>
<tr class="even">
<td align="center">10</td>
<td align="center">2014-06-19</td>
<td align="center">04:30:45</td>
<td align="center">40.37</td>
<td align="center">-7.91</td>
<td align="center">89.5</td>
<td align="center">23.58</td>
<td align="center">35.11</td>
</tr>
</tbody>
</table>
<p>I extracted the argo float information for station 206 and there are 217 casts made by this float. Manual extraction of CTD information one cast after the other is tedious and time consuming. Because of the danger of manual extraction of CTD information from argo float, I use a For loop to iterate the process for all 217 casts.</p>
<pre class="r"><code>argo.tb = NULL

for (i in 1:217){

profile = argo.list[[i]]@data%&gt;%
  as.data.frame()%&gt;%
  as.tibble()%&gt;%
  mutate(Date = argo.list[[i]]@metadata$startTime%&gt;%as_datetime(tz = &quot;&quot;), 
         Longitude = argo.list[[i]]@metadata$longitude, 
         Latitude = argo.list[[i]]@metadata$latitude)%&gt;%
  separate(Date, c(&quot;Date&quot;, &quot;Time&quot;),sep = &quot; &quot;, remove = TRUE)%&gt;%
  dplyr::select(Scan = scan, Date, Time, Longitude, Latitude, 
                Depth = pressure, Temperature = temperature, 
                Salinity = salinity)

argo.tb = argo.tb%&gt;%bind_rows(profile)

}</code></pre>
<p>Now I have a tibble of 15407 scan from 2017 measured from the surface to the deepest part at a particular location. However, I want only the surface information of salinity, and temperature from each cast. I used <em>filter</em> function from dplyr<a href="#fn9" class="footnoteRef" id="fnref9"><sup>9</sup></a> package to retain the first scan in each cast, which are measured at the surface (Table 2) and its trajectory figure <a href="#fig:trajectory">6</a></p>
<pre class="r"><code>argo.surface.tb =  argo.tb%&gt;%filter(Scan == 1)

knitr::kable(argo.surface.tb%&gt;%slice(1:10), caption = &quot;Table 2: Surface Argo floats measurements from Argo float number 1901124&quot;, digits = 2, align = &quot;c&quot;, row.names = FALSE, escape = T)</code></pre>
<table>
<caption><span id="tab:unnamed-chunk-7">Table 2: </span>Table 2: Surface Argo floats measurements from Argo float number 1901124</caption>
<thead>
<tr class="header">
<th align="center">Scan</th>
<th align="center">Date</th>
<th align="center">Time</th>
<th align="center">Longitude</th>
<th align="center">Latitude</th>
<th align="center">Depth</th>
<th align="center">Temperature</th>
<th align="center">Salinity</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center">1</td>
<td align="center">2008-10-28</td>
<td align="center">01:43:57</td>
<td align="center">64.03</td>
<td align="center">-21.64</td>
<td align="center">4.6</td>
<td align="center">23.55</td>
<td align="center">35.34</td>
</tr>
<tr class="even">
<td align="center">1</td>
<td align="center">2008-11-07</td>
<td align="center">02:17:07</td>
<td align="center">64.20</td>
<td align="center">-21.28</td>
<td align="center">4.3</td>
<td align="center">24.59</td>
<td align="center">35.04</td>
</tr>
<tr class="odd">
<td align="center">1</td>
<td align="center">2008-11-17</td>
<td align="center">02:30:18</td>
<td align="center">64.07</td>
<td align="center">-21.01</td>
<td align="center">4.4</td>
<td align="center">24.99</td>
<td align="center">35.02</td>
</tr>
<tr class="even">
<td align="center">1</td>
<td align="center">2008-11-27</td>
<td align="center">02:37:35</td>
<td align="center">63.61</td>
<td align="center">-21.10</td>
<td align="center">4.7</td>
<td align="center">25.71</td>
<td align="center">34.98</td>
</tr>
<tr class="odd">
<td align="center">1</td>
<td align="center">2008-12-07</td>
<td align="center">05:03:59</td>
<td align="center">63.43</td>
<td align="center">-21.25</td>
<td align="center">4.4</td>
<td align="center">26.10</td>
<td align="center">35.03</td>
</tr>
<tr class="even">
<td align="center">1</td>
<td align="center">2008-12-17</td>
<td align="center">03:03:40</td>
<td align="center">63.32</td>
<td align="center">-21.46</td>
<td align="center">4.8</td>
<td align="center">27.04</td>
<td align="center">35.13</td>
</tr>
<tr class="odd">
<td align="center">1</td>
<td align="center">2008-12-27</td>
<td align="center">05:09:53</td>
<td align="center">63.47</td>
<td align="center">-21.56</td>
<td align="center">4.6</td>
<td align="center">26.72</td>
<td align="center">35.08</td>
</tr>
<tr class="even">
<td align="center">1</td>
<td align="center">2009-01-06</td>
<td align="center">02:40:37</td>
<td align="center">63.90</td>
<td align="center">-21.60</td>
<td align="center">4.6</td>
<td align="center">28.40</td>
<td align="center">35.08</td>
</tr>
<tr class="odd">
<td align="center">1</td>
<td align="center">2009-01-16</td>
<td align="center">04:57:04</td>
<td align="center">64.45</td>
<td align="center">-21.49</td>
<td align="center">4.7</td>
<td align="center">27.99</td>
<td align="center">35.12</td>
</tr>
<tr class="even">
<td align="center">1</td>
<td align="center">2009-01-26</td>
<td align="center">02:30:53</td>
<td align="center">64.83</td>
<td align="center">-21.21</td>
<td align="center">4.6</td>
<td align="center">28.07</td>
<td align="center">34.96</td>
</tr>
</tbody>
</table>
<pre class="r"><code>data(&quot;world&quot;) ## medium resolution from spData package

ggplot()+
  geom_sf(data = world, fill = &quot;ivory&quot;, col = 1)+
  geom_path(data = argo.surface.tb, 
            aes(x = Longitude, y = Latitude), size =.5, col = 2)+
  geom_point(data = argo.surface.tb, aes(x = Longitude, y = Latitude), col = 2)+
  coord_sf(xlim = c(35, 71), ylim = c(-25,0))+
  ggrepel::geom_text_repel(data = argo.surface.tb%&gt;%slice(seq(3,217,25)),
                           aes(x = Longitude, y = Latitude, label = Date))+
  theme_bw()+
  theme(panel.background = element_rect(colour = 1, fill = &quot;lightblue&quot;),
        panel.grid = element_line(colour = NA),
        axis.text = element_text(colour = 1, size = 10))+
  labs(x = NULL, y = NULL)+
  ggsn::scalebar(location = &quot;bottomright&quot;, x.min = 35, 
                 x.max = 70, y.min = -25, y.max = 0, dist = 500, dd2km = T, 
                 model = &quot;WGS84&quot;,st.dist = 0.02, st.size = 4)</code></pre>
<div class="figure"><span id="fig:trajectory"></span>
<img src="/post/2018-09-19-get-satellite-data-with-r_files/figure-html/trajectory-1.png" alt="TRajectory of Argo float ID 1901124" width="672" />
<p class="caption">
Figure 6: TRajectory of Argo float ID 1901124
</p>
</div>
</div>
<div id="tracking-satellite-data-with-argo-float-as-tagged-data" class="section level3">
<h3>Tracking Satellite Data with Argo Float as Tagged Data</h3>
<p>The <em>argo.surface.tb</em> dataset consist of eight variables—<em>scan, date, time, longitude, latitude, depth, temperature and salinity</em> of 216 casts from Argo float with ID 1901124 measured from 2008-10-28 to 2014-09-27 in the Indian Ocean. The date, longitude, and latitude variables from this dataset was used as <em>xpos</em>, <em>ypos</em> and <em>tpos</em> arguments in the xtracto function.</p>
<pre class="r"><code>require(xtractomatic) ## load the package

modis.sst = xtracto(dtype = &quot;mhsstd8day&quot;,
                    xpos = argo.surface.tb$Longitude, 
                    ypos = argo.surface.tb$Latitude, 
                    tpos = argo.surface.tb$Date, ,#note a space here.A bug!!!!
                    xlen = 0.2, 
                    ylen = 0.2)

write_csv(modis.sst, &quot;modis_argo_match.csv&quot;)</code></pre>
</div>
<div id="tidying-the-data" class="section level3">
<h3>Tidying the data</h3>
<p>Once the data has been downloaded was saved in my working directory and parsed a command that prevent the execution of the chunk whenever we run the script. This dataset was then loaded as tibble in the workspace in the workspace. Because the dimension of the argo and modis tibble files are the same, it was easy to bind them together and then select some variables of interest of further and analysis (Table 3).</p>
<pre class="r"><code>## load the dataset
modis.sst = read_csv(&quot;E:/Data Manipulation/xtractomatic/modis_argo_match.csv&quot;)%&gt;%
  mutate(Date = as.Date(`satellite date`))

## make character date in argo.surface.tab as date format
argo.surface.tb$Date = as.Date(argo.surface.tb$Date)


## tidy the data
modis.argo.tb = argo.surface.tb%&gt;%
  dplyr::select(-c(Scan,Time, Salinity))%&gt;%
  bind_cols(modis.sst%&gt;%
              dplyr::select(satelliteDate = Date, n, 
                     satelliteMeanSST = `mean sst`))%&gt;%
  dplyr::select(Date, Longitude, Latitude, Temperature ,satelliteDate, n, satelliteMeanSST)

knitr::kable(modis.argo.tb%&gt;%sample_n(20), caption = &quot;Table 3: Tidied drifter and modis temperature data&quot;, digits = 2, align = &quot;l&quot;)</code></pre>
<pre class="r"><code># write_csv(modis.argo.tb, &quot;modis_argo_tb.csv&quot;)
modis.argo.tb = read_csv(&quot;E:/Data Manipulation/xtractomatic/modis_argo_tb.csv&quot;)</code></pre>
<pre><code>## Parsed with column specification:
## cols(
##   Date = col_date(format = &quot;&quot;),
##   Longitude = col_double(),
##   Latitude = col_double(),
##   Temperature = col_double(),
##   satelliteDate = col_date(format = &quot;&quot;),
##   n = col_integer(),
##   satelliteMeanSST = col_double()
## )</code></pre>
<pre class="r"><code>knitr::kable(modis.argo.tb%&gt;%sample_n(20), caption = &quot;Table 3: Tidied drifter and modis temperature data&quot;, digits = 2, align = &quot;l&quot;)</code></pre>
<table>
<caption><span id="tab:unnamed-chunk-10">Table 3: </span>Table 3: Tidied drifter and modis temperature data</caption>
<thead>
<tr class="header">
<th align="left">Date</th>
<th align="left">Longitude</th>
<th align="left">Latitude</th>
<th align="left">Temperature</th>
<th align="left">satelliteDate</th>
<th align="left">n</th>
<th align="left">satelliteMeanSST</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">2014-01-20</td>
<td align="left">49.11</td>
<td align="left">-11.10</td>
<td align="left">28.70</td>
<td align="left">2014-01-21</td>
<td align="left">7</td>
<td align="left">28.40</td>
</tr>
<tr class="even">
<td align="left">2009-06-15</td>
<td align="left">61.52</td>
<td align="left">-22.08</td>
<td align="left">24.65</td>
<td align="left">2009-06-14</td>
<td align="left">29</td>
<td align="left">24.59</td>
</tr>
<tr class="odd">
<td align="left">2011-10-13</td>
<td align="left">52.81</td>
<td align="left">-15.25</td>
<td align="left">24.90</td>
<td align="left">2011-10-12</td>
<td align="left">33</td>
<td align="left">24.44</td>
</tr>
<tr class="even">
<td align="left">2012-05-20</td>
<td align="left">55.50</td>
<td align="left">-16.58</td>
<td align="left">27.09</td>
<td align="left">2012-05-20</td>
<td align="left">36</td>
<td align="left">26.99</td>
</tr>
<tr class="odd">
<td align="left">2011-05-06</td>
<td align="left">52.39</td>
<td align="left">-15.58</td>
<td align="left">28.32</td>
<td align="left">2011-05-05</td>
<td align="left">30</td>
<td align="left">28.02</td>
</tr>
<tr class="even">
<td align="left">2013-07-14</td>
<td align="left">52.79</td>
<td align="left">-11.84</td>
<td align="left">25.53</td>
<td align="left">2013-07-16</td>
<td align="left">34</td>
<td align="left">25.55</td>
</tr>
<tr class="odd">
<td align="left">2009-11-12</td>
<td align="left">55.28</td>
<td align="left">-20.52</td>
<td align="left">25.55</td>
<td align="left">2009-11-13</td>
<td align="left">30</td>
<td align="left">25.48</td>
</tr>
<tr class="even">
<td align="left">2009-01-26</td>
<td align="left">64.83</td>
<td align="left">-21.21</td>
<td align="left">28.07</td>
<td align="left">2009-01-29</td>
<td align="left">36</td>
<td align="left">28.58</td>
</tr>
<tr class="odd">
<td align="left">2009-11-02</td>
<td align="left">55.77</td>
<td align="left">-20.94</td>
<td align="left">25.13</td>
<td align="left">2009-11-05</td>
<td align="left">24</td>
<td align="left">25.72</td>
</tr>
<tr class="even">
<td align="left">2010-09-18</td>
<td align="left">50.89</td>
<td align="left">-21.36</td>
<td align="left">24.47</td>
<td align="left">2010-09-18</td>
<td align="left">25</td>
<td align="left">24.67</td>
</tr>
<tr class="odd">
<td align="left">2010-12-27</td>
<td align="left">50.35</td>
<td align="left">-18.89</td>
<td align="left">28.26</td>
<td align="left">2010-12-29</td>
<td align="left">30</td>
<td align="left">28.48</td>
</tr>
<tr class="even">
<td align="left">2013-08-03</td>
<td align="left">51.67</td>
<td align="left">-11.68</td>
<td align="left">25.04</td>
<td align="left">2013-08-01</td>
<td align="left">20</td>
<td align="left">24.63</td>
</tr>
<tr class="odd">
<td align="left">2011-11-12</td>
<td align="left">53.00</td>
<td align="left">-16.25</td>
<td align="left">26.22</td>
<td align="left">2011-11-13</td>
<td align="left">36</td>
<td align="left">26.04</td>
</tr>
<tr class="even">
<td align="left">2013-06-04</td>
<td align="left">53.31</td>
<td align="left">-13.38</td>
<td align="left">26.31</td>
<td align="left">2013-06-06</td>
<td align="left">25</td>
<td align="left">25.42</td>
</tr>
<tr class="odd">
<td align="left">2012-10-17</td>
<td align="left">52.56</td>
<td align="left">-14.48</td>
<td align="left">25.47</td>
<td align="left">2012-10-19</td>
<td align="left">30</td>
<td align="left">24.24</td>
</tr>
<tr class="even">
<td align="left">2014-01-30</td>
<td align="left">47.83</td>
<td align="left">-10.58</td>
<td align="left">28.81</td>
<td align="left">2014-01-29</td>
<td align="left">36</td>
<td align="left">29.05</td>
</tr>
<tr class="odd">
<td align="left">2014-06-29</td>
<td align="left">40.22</td>
<td align="left">-7.10</td>
<td align="left">26.21</td>
<td align="left">2014-06-30</td>
<td align="left">36</td>
<td align="left">26.21</td>
</tr>
<tr class="even">
<td align="left">2009-03-27</td>
<td align="left">64.91</td>
<td align="left">-22.14</td>
<td align="left">27.64</td>
<td align="left">2009-03-26</td>
<td align="left">30</td>
<td align="left">27.67</td>
</tr>
<tr class="odd">
<td align="left">2014-04-30</td>
<td align="left">45.81</td>
<td align="left">-8.11</td>
<td align="left">28.20</td>
<td align="left">2014-04-27</td>
<td align="left">30</td>
<td align="left">27.86</td>
</tr>
<tr class="even">
<td align="left">2011-02-15</td>
<td align="left">52.35</td>
<td align="left">-16.20</td>
<td align="left">25.03</td>
<td align="left">2011-02-14</td>
<td align="left">10</td>
<td align="left">24.80</td>
</tr>
</tbody>
</table>
<pre class="r"><code>rsq = cor(modis.argo.tb$Temperature, modis.argo.tb$satelliteMeanSST)%&gt;%
  round(2)

fit = lm(modis.argo.tb$Temperature~modis.argo.tb$satelliteMeanSST, method = &quot;qr&quot;, model = TRUE)
summary(fit)</code></pre>
<pre><code>## 
## Call:
## lm(formula = modis.argo.tb$Temperature ~ modis.argo.tb$satelliteMeanSST, 
##     method = &quot;qr&quot;, model = TRUE)
## 
## Residuals:
##      Min       1Q   Median       3Q      Max 
## -2.22086 -0.20670 -0.02381  0.22081  2.04826 
## 
## Coefficients:
##                                Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)                     1.86593    0.45913   4.064 6.77e-05 ***
## modis.argo.tb$satelliteMeanSST  0.93127    0.01718  54.194  &lt; 2e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 0.4388 on 214 degrees of freedom
## Multiple R-squared:  0.9321, Adjusted R-squared:  0.9318 
## F-statistic:  2937 on 1 and 214 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
<div id="accuracy-measures" class="section level3">
<h3>Accuracy Measures</h3>
<pre class="r"><code>accuracy = pracma::rmserr(x = modis.argo.tb$Temperature,
               y = modis.argo.tb$satelliteMeanSST,
               summary = FALSE)</code></pre>
<p>To understand the accuracy of surface temperature measured with argo floats and satellite, I used a prominent root mean square error (RMSE) technique. A <em>pracma</em> package has <em>rmserr</em> function that deals with accuracy assessment of six different types. The result showed the two data collection technique are fairly very close with an accuracy of 0.454053 degree centigrade</p>
<p>The correlation coefficient of surface temperature measured by Argo and MODIS was found to be R^2 = 0.9321 (Figure <a href="#fig:cor">7</a>).This correlation indicate that the two data sources have significant association of about 93 percent (p &lt; 0.05). Therefore, we can trust the sea surface temperature data from MODIS sensor as its measurements are close to those collected in-situ with Argo floats.</p>
<pre class="r"><code>ggplot(data = modis.argo.tb,
       aes(x = Temperature, y = satelliteMeanSST))+
  geom_point()+
  geom_smooth(method = &quot;lm&quot;, col = 2, se = FALSE)+
  theme(panel.background = element_rect(colour = 1),
        axis.text = element_text(colour = 1, size = 12), 
        axis.title = element_text(colour = 1, size = 14))+
 geom_text(aes(x = 29, y = 24, 
               label = paste(&quot;RSq = &quot;, 0.93)), size = 4)+
  scale_x_continuous(breaks = seq(23.5,29.5, 1.5))+
  scale_y_continuous(breaks = seq(23,31, 1.5))+
    labs(y=expression(~Modis~Sensor~SST~(~degree~C)), x=expression(~Argo~float~Temperature~(~degree~C)))</code></pre>
<div class="figure"><span id="fig:cor"></span>
<img src="/post/2018-09-19-get-satellite-data-with-r_files/figure-html/cor-1.png" alt="Correlation of temperature between Argo float and MODIS surface temperature" width="672" />
<p class="caption">
Figure 7: Correlation of temperature between Argo float and MODIS surface temperature
</p>
</div>
</div>
<div id="cited-articles" class="section level3">
<h3>Cited Articles</h3>
</div>
<div class="footnotes">
<hr />
<ol>
<li id="fn1"><p>Paul Febvre, CTO of the Satellite Applications Catapult (SAC), which aims to bring together academia and businesses, as well as opening the sector to new markets<a href="#fnref1">↩</a></p></li>
<li id="fn2"><p>Mendelssohn, R. (2017). xtractomatic: accessing environmental data from ERD’s ERDDAP server. R package version, 3(2)<a href="#fnref2">↩</a></p></li>
<li id="fn3"><p>Wickham, H. (2017). Tidyverse: Easily install and load’tidyverse’packages. R package version, 1(1)<a href="#fnref3">↩</a></p></li>
<li id="fn4"><p>Grolemund, G., &amp; Wickham, H. (2013). lubridate: Make dealing with dates a little easier. R package version, 1(3).<a href="#fnref4">↩</a></p></li>
<li id="fn5"><p>Lovelace, R., Nowosad, J., &amp; Muenchow, J. Geocomputation with R.<a href="#fnref5">↩</a></p></li>
<li id="fn6"><p>Pebesma, E. (2016). sf: Simple Features for R.<a href="#fnref6">↩</a></p></li>
<li id="fn7"><p>Kelley, D., &amp; Richards, C. (2017). oce: Analysis of Oceanographic Data. R package version 0.9-22.<a href="#fnref7">↩</a></p></li>
<li id="fn8"><p>Corripio, J. G. (2014). Insol: solar radiation. R package version, 1(1), 2014.<a href="#fnref8">↩</a></p></li>
<li id="fn9"><p>Wickham, H., Francois, R., Henry, L., &amp; Müller, K. (2018). dplyr: A grammar of data manipulation. R package version 0.7, 6.<a href="#fnref9">↩</a></p></li>
</ol>
</div>

    </div>
  </article>

  
<section id="comments">
  <div id="disqus_thread"></div>
  <script>
  var disqus_config = function () {
  
  };
  (function() {
    var inIFrame = function() {
      var iframe = true;
      try { iframe = window.self !== window.top; } catch (e) {}
      return iframe;
    };
    if (inIFrame()) return;
    var d = document, s = d.createElement('script');
    s.src = '//https-semba-blog-netlify-com.disqus.com/embed.js'; s.async = true;
    s.setAttribute('data-timestamp', +new Date());
    (d.head || d.body).appendChild(s);
  })();
  </script>
  <noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
</section>



</main>

      <footer class="footer">
        <ul class="footer-links">
          <li>
            <a href="/index.xml" type="application/rss+xml" target="_blank">RSS feed</a>
          </li>
          <li>
            <a href="https://gohugo.io/" class="footer-links-kudos">Made with <img src="/images/hugo-logo.png" alt="Img link to Hugo website" width="22" height="22"></a>
          </li>
        </ul>
      </footer>

    </div>
    



<script src="//cdn.bootcss.com/highlight.js/9.11.0/highlight.min.js"></script>



<script src="//cdn.bootcss.com/highlight.js/9.11.0/languages/r.min.js"></script>
<script src="//cdn.bootcss.com/highlight.js/9.11.0/languages/yaml.min.js"></script>
<script>hljs.configure({languages: []}); hljs.initHighlightingOnLoad();</script>



    
<script src="/js/math-code.js"></script>
<script async src="//cdn.bootcss.com/mathjax/2.7.1/MathJax.js?config=TeX-MML-AM_CHTML"></script>


    
<script type="application/javascript">
var doNotTrack = false;
if (!doNotTrack) {
	(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
	(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
	m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
	})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
	ga('create', 'UA-127756435-1', 'auto');
	
	ga('send', 'pageview');
}
</script>

  </body>
</html>

